{{ define "structured-data" }}
{{ $i := 1 }}
{{ $s := slice }}
{{ range .Sections.ByTitle }}

{{ $s = $s | append (slice (dict "@type" "ListItem" "position" $i "name" .Title "item" .Permalink)) }}
{{ $i = add $i 1 }}
{{ end }}
{{ range .RegularPages.Reverse }}
{{ if not .Params.NoList }}
{{ $s = $s | append (slice (dict "@type" "ListItem" "position" $i "name" .Title "item" .Permalink)) }}
{{ $i = add $i 1  }}
{{ end }}
{{ end }}
{{ $m := dict
  "@context" "https://schema.org"
  "@type" "BreadcrumbList"
  "itemListElement" $s
}}
<script type="application/ld+json">
{{ encoding.Jsonify $m | safe.JS }}
</script>
{{ end }}
{{ define "main" }}
<h3 class="center-text">{{ .Description }}</h3>
<article>
  <div class="center-text">{{ .Content }}</div>
</article>
{{ if .Sections }}
<ul>
{{ range .Sections.ByTitle }}
<li><a href="{{ .Permalink }}">{{ .Title }}/</a>{{ if .Description }}&nbsp;-&nbsp;{{ .Description }}{{ end }}</li>
{{ if le .Pages 5 }}
{{ if .Sections }}
  <ul>
  {{ range .Sections.ByTitle }}
  <li><a href="{{ .Permalink }}">{{ .Title }}/</a>{{ if .Description }}&nbsp;-&nbsp;{{ .Description }}{{ end }}</li>
  {{ end }}
  </ul>
{{ end }}
{{ if .RegularPages }}
  <ul>
    {{ range .RegularPages.Reverse }}
    {{ $show_dates := .Params.ShowDates }}
    {{ $published := .PublishDate.Format "January _2, 2006" }}
    {{ $published_dt := .PublishDate.Format "2006-01-02" }}
    <li><a href="{{ .Permalink }}">{{ .Title }}</a>{{ if or .Description $show_dates }}&nbsp;-{{ end }}{{ if .Description }}&nbsp;{{ .Description }}{{ end }}{{ if $show_dates }}&nbsp;<time class="small" datetime="{{ $published_dt }}">({{ $published }})</time>{{ end }}</li>
    {{ end }}
  </ul>
{{ end }}
{{ end }}
{{ end }}
</ul>
{{ end }}
{{ if .RegularPages }}
<ul>
  {{ range .RegularPages.Reverse }}
  {{ $show_dates := .Params.ShowDates }}
  {{ $published := .PublishDate.Format "January _2, 2006" }}
  {{ $published_dt := .PublishDate.Format "2006-01-02" }}
  {{ if not .Params.NoList }}
  <li><a href="{{ .Permalink }}">{{ .Title }}</a>{{ if or .Description $show_dates}}&nbsp;-{{ end }}{{ if .Description }}&nbsp;{{ .Description }}{{ end }}{{ if $show_dates }}&nbsp;<time class="small" datetime="{{ $published_dt }}">({{ $published }})</time>{{ end }}</li>
  {{ end }}
  {{ end }}
</ul>
{{ else }}
<p class="center-text">Nothing yet.</p>
{{ end }}
{{ end }}
